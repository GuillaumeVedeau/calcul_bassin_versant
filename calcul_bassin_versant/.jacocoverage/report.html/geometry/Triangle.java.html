<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="fr"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>Triangle.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;calcul_bassin_versant&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">geometry</a> &gt; <span class="el_source">Triangle.java</span></div><h1>Triangle.java</h1><pre class="source lang-java linenums">/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package geometry;

import java.util.ArrayList;

/**
 * gere les objet de type Triangle
 *
 * @author Utilisateur
 */
public class Triangle {

    private int segment1;
    private int segment2;
    private int segment3;

    private int point1;
    private int point2;
    private int point3;
    // approximation par defaut faite sur les calcul d'angle (1°)
<span class="fc" id="L25">    private static double approximationAngulaire = 0.16;</span>

    /**
     * Basic constructor based on Segment :the order of the point is based on
     * the common point between each segment
     *
     * @param segment1
     * @param segment2
     * @param segment3
     * @param segments
     * @param points
     */
<span class="fc" id="L37">    public Triangle(int segment1, int segment2, int segment3, ArrayList&lt;Segment&gt; segments, ArrayList&lt;Point3D&gt; points) {</span>

<span class="fc" id="L39">        this.segment1 = segment1;</span>
<span class="fc" id="L40">        this.segment2 = segment2;</span>
<span class="fc" id="L41">        this.segment3 = segment3;</span>

<span class="fc bfc" id="L43" title="All 4 branches covered.">        if (segments.get(segment1).getPoint1() == segments.get(segment2).getPoint1() || segments.get(segment1).getPoint1() == segments.get(segment2).getPoint2()) {</span>
<span class="fc" id="L44">            this.point1 = segments.get(segment1).getPoint2();</span>
<span class="fc" id="L45">            this.point2 = segments.get(segment1).getPoint1();</span>

<span class="fc bfc" id="L47" title="All 2 branches covered.">            if (segments.get(segment1).getPoint1() == segments.get(segment2).getPoint1()) {</span>
<span class="fc" id="L48">                this.point3 = segments.get(segment2).getPoint2();</span>
            } else {
<span class="fc" id="L50">                this.point3 = segments.get(segment2).getPoint1();</span>
            }
        } else {
<span class="fc" id="L53">            this.point1 = segments.get(segment1).getPoint1();</span>
<span class="fc" id="L54">            this.point2 = segments.get(segment1).getPoint2();</span>

<span class="fc bfc" id="L56" title="All 2 branches covered.">            if (segments.get(segment1).getPoint2() == segments.get(segment2).getPoint1()) {</span>
<span class="fc" id="L57">                this.point3 = segments.get(segment2).getPoint2();</span>
            } else {
<span class="fc" id="L59">                this.point3 = segments.get(segment2).getPoint1();</span>
            }
        }
<span class="fc" id="L62">    }</span>

    /**
     * basic constructor based on Point It cannot be used as it is in the
     * program, but need to be called by the other method construction
     * beforehand.
     *
     * @param point1
     * @param point2
     * @param point3
     */
<span class="fc" id="L73">    public Triangle(int point1, int point2, int point3) {</span>
<span class="fc" id="L74">        this.point1 = point1;</span>
<span class="fc" id="L75">        this.point2 = point2;</span>
<span class="fc" id="L76">        this.point3 = point3;</span>
<span class="fc" id="L77">        this.segment1 = 0;</span>
<span class="fc" id="L78">        this.segment2 = 0;</span>
<span class="fc" id="L79">        this.segment3 = 0;</span>
<span class="fc" id="L80">    }</span>

    /**
     * default constructor
     */
<span class="fc" id="L85">    public Triangle() {</span>
<span class="fc" id="L86">        this.point1 = 0;</span>
<span class="fc" id="L87">        this.point2 = 0;</span>
<span class="fc" id="L88">        this.point3 = 0;</span>
<span class="fc" id="L89">        this.segment1 = 0;</span>
<span class="fc" id="L90">        this.segment2 = 0;</span>
<span class="fc" id="L91">        this.segment3 = 0;</span>
<span class="fc" id="L92">    }</span>

    /**
     * Get the value of segment3
     *
     * @return the value of segment3
     */
    public int getSegment3() {
<span class="fc" id="L100">        return segment3;</span>
    }

    /**
     * Set the value of segment3
     *
     * @param segment3 new value of segment3
     */
    public void setSegment3(int segment3) {
<span class="fc" id="L109">        this.segment3 = segment3;</span>
<span class="fc" id="L110">    }</span>

    /**
     * Get the value of segment2
     *
     * @return the value of segment2
     */
    public int getSegment2() {
<span class="fc" id="L118">        return segment2;</span>
    }

    /**
     * Set the value of segment2
     *
     * @param segment2 new value of segment2
     */
    public void setSegment2(int segment2) {
<span class="fc" id="L127">        this.segment2 = segment2;</span>
<span class="fc" id="L128">    }</span>

    /**
     * Get the value of segment1
     *
     * @return the value of segment1
     */
    public int getSegment1() {
<span class="fc" id="L136">        return segment1;</span>
    }

    /**
     * Set the value of segment1
     *
     * @param segment1 new value of segment1
     */
    public void setSegment1(int segment1) {
<span class="fc" id="L145">        this.segment1 = segment1;</span>
<span class="fc" id="L146">    }</span>

    /**
     * Get the value of point1
     *
     * @return the value of point1
     */
    public int getPoint1() {
<span class="fc" id="L154">        return point1;</span>
    }

    /**
     * Set the value of segment1
     *
     * @param point1 new value of point1
     */
    public void setPoint1(int point1) {
<span class="fc" id="L163">        this.point1 = point1;</span>
<span class="fc" id="L164">    }</span>

    /**
     * Get the value of point2
     *
     * @return the value of point2
     */
    public int getPoint2() {
<span class="fc" id="L172">        return point2;</span>
    }

    /**
     * Set the value of segment2
     *
     * @param point2 new value of point2
     */
    public void setPoint2(int point2) {
<span class="fc" id="L181">        this.point2 = point2;</span>
<span class="fc" id="L182">    }</span>

    /**
     * Get the value of point3
     *
     * @return the value of point3
     */
    public int getPoint3() {
<span class="fc" id="L190">        return point3;</span>
    }

    /**
     * Set the value of segment3
     *
     * @param point3 new value of point3
     */
    public void setPoint3(int point3) {
<span class="fc" id="L199">        this.point3 = point3;</span>
<span class="fc" id="L200">    }</span>

    /**
     * Build the objects Segment needed in the program and
     *
     * @param triangles
     * @param segments if there are allready some
     */
    public static void construction(ArrayList&lt;Triangle&gt; triangles, ArrayList&lt;Segment&gt; segments) {

        boolean found1, found2, found3;
        int posSegment;
<span class="fc" id="L212">        int posTriangle = 0;</span>

<span class="fc bfc" id="L214" title="All 2 branches covered.">        for (Triangle triangle : triangles) {</span>

<span class="pc bpc" id="L216" title="1 of 2 branches missed.">            if (triangle != null) {</span>

<span class="pc bpc" id="L218" title="1 of 2 branches missed.">                if (triangle.getSegment1() &lt;= 0) {</span>

<span class="fc" id="L220">                    found1 = false;</span>
<span class="fc" id="L221">                    posSegment = 0;</span>
<span class="fc bfc" id="L222" title="All 2 branches covered.">                    for (Segment segment : segments) {</span>

<span class="fc bfc" id="L224" title="All 4 branches covered.">                        if (segment.getPoint1() == triangle.getPoint1() &amp;&amp; segment.getPoint2() == triangle.getPoint2()) {</span>
<span class="fc" id="L225">                            triangle.setSegment1(posSegment);</span>
<span class="fc" id="L226">                            segment.setTrigauche(posTriangle);</span>
<span class="fc" id="L227">                            found1 = true;</span>
                        }
<span class="fc bfc" id="L229" title="All 4 branches covered.">                        if ((segment.getPoint2() == triangle.getPoint1() &amp;&amp; segment.getPoint1() == triangle.getPoint2())) {</span>
<span class="fc" id="L230">                            triangle.setSegment1(posSegment);</span>
<span class="fc" id="L231">                            segment.setTridroit(posTriangle);</span>
<span class="fc" id="L232">                            found1 = true;</span>
                        }
<span class="fc" id="L234">                        posSegment++;</span>
<span class="fc" id="L235">                    }</span>
<span class="fc bfc" id="L236" title="All 2 branches covered.">                    if (!found1) {</span>

<span class="fc" id="L238">                        triangle.setSegment1(segments.size());</span>
<span class="fc" id="L239">                        segments.add(new Segment(triangle.getPoint1(), triangle.getPoint2(), 0, posTriangle));</span>
                    }
                }

<span class="pc bpc" id="L243" title="1 of 2 branches missed.">                if (triangle.getSegment2() &lt;= 0) {</span>

<span class="fc" id="L245">                    found2 = false;</span>
<span class="fc" id="L246">                    posSegment = 0;</span>
<span class="fc bfc" id="L247" title="All 2 branches covered.">                    for (Segment segment : segments) {</span>

<span class="fc bfc" id="L249" title="All 4 branches covered.">                        if (segment.getPoint1() == triangle.getPoint2() &amp;&amp; segment.getPoint2() == triangle.getPoint3()) {</span>
<span class="fc" id="L250">                            triangle.setSegment2(posSegment);</span>
<span class="fc" id="L251">                            segment.setTrigauche(posTriangle);</span>
<span class="fc" id="L252">                            found2 = true;</span>
                        }
<span class="fc bfc" id="L254" title="All 4 branches covered.">                        if ((segment.getPoint2() == triangle.getPoint2() &amp;&amp; segment.getPoint1() == triangle.getPoint3())) {</span>
<span class="fc" id="L255">                            triangle.setSegment2(posSegment);</span>
<span class="fc" id="L256">                            segment.setTridroit(posTriangle);</span>
<span class="fc" id="L257">                            found2 = true;</span>
                        }
<span class="fc" id="L259">                        posSegment++;</span>
<span class="fc" id="L260">                    }</span>
<span class="fc bfc" id="L261" title="All 2 branches covered.">                    if (!found2) {</span>

<span class="fc" id="L263">                        triangle.setSegment2(segments.size());</span>
<span class="fc" id="L264">                        segments.add(new Segment(triangle.getPoint2(), triangle.getPoint3(), 0, posTriangle));</span>
                    }
                }

<span class="pc bpc" id="L268" title="1 of 2 branches missed.">                if (triangle.getSegment3() &lt;= 0) {</span>

<span class="fc" id="L270">                    found3 = false;</span>
<span class="fc" id="L271">                    posSegment = 0;</span>
<span class="fc bfc" id="L272" title="All 2 branches covered.">                    for (Segment segment : segments) {</span>

<span class="fc bfc" id="L274" title="All 4 branches covered.">                        if (segment.getPoint1() == triangle.getPoint3() &amp;&amp; segment.getPoint2() == triangle.getPoint1()) {</span>
<span class="fc" id="L275">                            triangle.setSegment3(posSegment);</span>
<span class="fc" id="L276">                            segment.setTrigauche(posTriangle);</span>
<span class="fc" id="L277">                            found3 = true;</span>
                        }
<span class="fc bfc" id="L279" title="All 4 branches covered.">                        if ((segment.getPoint2() == triangle.getPoint3() &amp;&amp; segment.getPoint1() == triangle.getPoint1())) {</span>
<span class="fc" id="L280">                            triangle.setSegment3(posSegment);</span>
<span class="fc" id="L281">                            segment.setTridroit(posTriangle);</span>
<span class="fc" id="L282">                            found3 = true;</span>
                        }
<span class="fc" id="L284">                        posSegment++;</span>
<span class="fc" id="L285">                    }</span>
<span class="fc bfc" id="L286" title="All 2 branches covered.">                    if (!found3) {</span>

<span class="fc" id="L288">                        triangle.setSegment3(segments.size());</span>
<span class="fc" id="L289">                        segments.add(new Segment(triangle.getPoint3(), triangle.getPoint1(), 0, posTriangle));</span>
                    }
                }
            }
<span class="fc" id="L293">            posTriangle++;</span>
<span class="fc" id="L294">        }</span>

<span class="fc" id="L296">    }</span>

    @Override
    /**
     * surcharge de toString
     */
    public String toString() {
<span class="fc" id="L303">        return (&quot;\n\nTriangle:&quot; + &quot;\n\tpoint1\t&quot; + point1 + &quot;\n\tpoint2\t&quot; + point2 + &quot;\n\tpoint3\t&quot; + point3 + &quot;\n\tseg1\t&quot; + segment1 + &quot;\n\tseg2\t&quot; + segment2 + &quot;\n\tseg3\t&quot; + segment3);</span>
    }

    /**
     * Renvoie l'égalité complete entre 2 objets de type Triangle ( les objets
     * le constituant sont identiques)
     *
     * @param triangle
     * @return
     */
    public boolean equals(Triangle triangle) {

<span class="pc bpc" id="L315" title="1 of 2 branches missed.">        if (triangle == null) {</span>
<span class="nc" id="L316">            return false;</span>
        } else {

<span class="fc bfc" id="L319" title="All 2 branches covered.">            return ((this.getPoint1() == triangle.getPoint1()</span>
<span class="fc bfc" id="L320" title="All 2 branches covered.">                    &amp;&amp; this.getPoint2() == triangle.getPoint2()</span>
<span class="pc bpc" id="L321" title="1 of 2 branches missed.">                    &amp;&amp; this.getPoint3() == triangle.getPoint3())</span>
<span class="fc bfc" id="L322" title="All 2 branches covered.">                    || (this.getPoint1() == (triangle.getPoint2())</span>
<span class="fc bfc" id="L323" title="All 2 branches covered.">                    &amp;&amp; this.getPoint2() == (triangle.getPoint3())</span>
<span class="pc bpc" id="L324" title="1 of 2 branches missed.">                    &amp;&amp; this.getPoint3() == (triangle.getPoint1()))</span>
<span class="fc bfc" id="L325" title="All 2 branches covered.">                    || (this.getPoint1() == (triangle.getPoint3())</span>
<span class="pc bpc" id="L326" title="1 of 2 branches missed.">                    &amp;&amp; this.getPoint2() == (triangle.getPoint1())</span>
<span class="pc bnc" id="L327" title="All 2 branches missed.">                    &amp;&amp; this.getPoint3() == (triangle.getPoint2())));</span>
        }
    }

    /**
     * Get the value of approximation angulaire
     *
     * @return the value of approximation angulaire
     */
    public static double getApproximationAngulaire() {
<span class="nc" id="L337">        return approximationAngulaire;</span>
    }

    /**
     * Set the value of approximation angulaire
     *
     * @param appro new value of approximation angulaire
     */
    public static void setApproximationAngulaire(double appro) {
<span class="nc" id="L346">        approximationAngulaire = appro;</span>
<span class="nc" id="L347">    }</span>

    /**
     * calcule le vecteur pente en 2D indiquant la direction de plus forte
     * descente d'une surface en 2.5D
     *
     * @return
     */
    public Vecteur calculPente(ArrayList&lt;Point3D&gt; points) {
<span class="fc" id="L356">        Vecteur pente = new Vecteur(0, 0);</span>
<span class="fc" id="L357">        double x1 = points.get(this.getPoint1()).getPosx() - points.get(this.getPoint2()).getPosx();</span>
<span class="fc" id="L358">        double x2 = points.get(this.getPoint1()).getPosx() - points.get(this.getPoint3()).getPosx();</span>
<span class="fc" id="L359">        double y1 = points.get(this.getPoint1()).getPosy() - points.get(this.getPoint2()).getPosy();</span>
<span class="fc" id="L360">        double y2 = points.get(this.getPoint1()).getPosy() - points.get(this.getPoint3()).getPosy();</span>
<span class="fc" id="L361">        double z1 = points.get(this.getPoint1()).getPosz() - points.get(this.getPoint2()).getPosz();</span>
<span class="fc" id="L362">        double z2 = points.get(this.getPoint1()).getPosz() - points.get(this.getPoint3()).getPosz();</span>

<span class="fc bfc" id="L364" title="All 2 branches covered.">        if (x1 * y2 - y1 * x2 &gt;= 0) {</span>
<span class="fc" id="L365">            pente.setValx((y1 * z2 - z1 * y2));</span>
<span class="fc" id="L366">            pente.setValy((z1 * x2 - x1 * z2));</span>
        } else {
<span class="fc" id="L368">            pente.setValx(-(y1 * z2 - z1 * y2));</span>
<span class="fc" id="L369">            pente.setValy(-(z1 * x2 - x1 * z2));</span>
        }

<span class="fc" id="L372">        return pente;</span>
    }

    /**
     * calcule la part d'un triangle faisant partie du bassin versant sachant le
     * segment qui l'y relie, et propage ensuite selon les nouveaux segments qui
     * y sont rattaché
     *
     * @param segment
     * @param triangles
     * @param segments
     * @param points
     * @param bassinVersant
     */
    public void calculProjete(int segment, ArrayList&lt;Triangle&gt; triangles, ArrayList&lt;Segment&gt; segments, ArrayList&lt;Point3D&gt; points, ArrayList&lt;Triangle&gt; bassinVersant) {
        
        
<span class="fc bfc" id="L389" title="All 6 branches covered.">        if ((!segments.get(segment).gettraiteDroit() &amp;&amp; this.equals(triangles.get(segments.get(segment).getTridroit()))) || (!segments.get(segment).getTraiteGauche()</span>
<span class="fc bfc" id="L390" title="All 2 branches covered.">                &amp;&amp; this.equals(triangles.get(segments.get(segment).getTrigauche())))) {</span>

<span class="fc bfc" id="L392" title="All 2 branches covered.">            if (this.equals(triangles.get(segments.get(segment).getTridroit()))) {</span>
<span class="fc" id="L393">                segments.get(segment).setTraiteDroit(true);</span>
            } else {
<span class="fc" id="L395">                segments.get(segment).setTraiteGauche(true);</span>
            }

<span class="fc" id="L398">            int pointA = 0, pointB = 0, pointC = 0;</span>
<span class="fc" id="L399">            int segmentAB = 0, segmentBC = 0, segmentAC = 0;</span>

<span class="fc" id="L401">            Vecteur pente = this.calculPente(points);</span>

<span class="fc bfc" id="L403" title="All 2 branches covered.">            if (segments.get(segment).getPoint1() == this.getPoint1()) {</span>

<span class="fc bfc" id="L405" title="All 2 branches covered.">                if (segments.get(segment).getPoint2() == this.getPoint2()) {</span>

<span class="fc" id="L407">                    pointA = this.getPoint3();</span>
<span class="fc" id="L408">                    pointB = this.getPoint1();</span>
<span class="fc" id="L409">                    pointC = this.getPoint2();</span>
<span class="fc" id="L410">                    segmentAB = this.getSegment3();</span>
<span class="fc" id="L411">                    segmentBC = this.getSegment1();</span>
<span class="fc" id="L412">                    segmentAC = this.getSegment2();</span>
                } else {
<span class="fc" id="L414">                    pointA = this.getPoint2();</span>
<span class="fc" id="L415">                    pointB = this.getPoint3();</span>
<span class="fc" id="L416">                    pointC = this.getPoint1();</span>
<span class="fc" id="L417">                    segmentAB = this.getSegment2();</span>
<span class="fc" id="L418">                    segmentBC = this.getSegment3();</span>
<span class="fc" id="L419">                    segmentAC = this.getSegment1();</span>
                }
            }

<span class="fc bfc" id="L423" title="All 2 branches covered.">            if (segments.get(segment).getPoint1() == this.getPoint2()) {</span>

<span class="fc bfc" id="L425" title="All 2 branches covered.">                if (segments.get(segment).getPoint2() == this.getPoint3()) {</span>

<span class="fc" id="L427">                    pointA = this.getPoint1();</span>
<span class="fc" id="L428">                    pointB = this.getPoint2();</span>
<span class="fc" id="L429">                    pointC = this.getPoint3();</span>
<span class="fc" id="L430">                    segmentAB = this.getSegment1();</span>
<span class="fc" id="L431">                    segmentBC = this.getSegment2();</span>
<span class="fc" id="L432">                    segmentAC = this.getSegment3();</span>
                } else {
<span class="fc" id="L434">                    pointA = this.getPoint3();</span>
<span class="fc" id="L435">                    pointB = this.getPoint1();</span>
<span class="fc" id="L436">                    pointC = this.getPoint2();</span>
<span class="fc" id="L437">                    segmentAB = this.getSegment3();</span>
<span class="fc" id="L438">                    segmentBC = this.getSegment1();</span>
<span class="fc" id="L439">                    segmentAC = this.getSegment2();</span>
                }
            }

<span class="fc bfc" id="L443" title="All 2 branches covered.">            if (segments.get(segment).getPoint1() == this.getPoint3()) {</span>

<span class="fc bfc" id="L445" title="All 2 branches covered.">                if (segments.get(segment).getPoint2() == this.getPoint1()) {</span>

<span class="fc" id="L447">                    pointA = this.getPoint2();</span>
<span class="fc" id="L448">                    pointB = this.getPoint3();</span>
<span class="fc" id="L449">                    pointC = this.getPoint1();</span>
<span class="fc" id="L450">                    segmentAB = this.getSegment2();</span>
<span class="fc" id="L451">                    segmentBC = this.getSegment3();</span>
<span class="fc" id="L452">                    segmentAC = this.getSegment1();</span>
                } else {
<span class="fc" id="L454">                    pointA = this.getPoint1();</span>
<span class="fc" id="L455">                    pointB = this.getPoint2();</span>
<span class="fc" id="L456">                    pointC = this.getPoint3();</span>
<span class="fc" id="L457">                    segmentAB = this.getSegment1();</span>
<span class="fc" id="L458">                    segmentBC = this.getSegment2();</span>
<span class="fc" id="L459">                    segmentAC = this.getSegment3();</span>
                }
            }

<span class="fc" id="L463">            double angleBC = (new Vecteur(points.get(pointB), points.get(pointC)).calculAngle());</span>
<span class="fc" id="L464">            double angleCB = (new Vecteur(points.get(pointC), points.get(pointB)).calculAngle());</span>

<span class="fc" id="L466">            double angleAB = (new Vecteur(points.get(pointA), points.get(pointB)).calculAngle());</span>
<span class="fc" id="L467">            double angleAC = (new Vecteur(points.get(pointA), points.get(pointC)).calculAngle());</span>

<span class="fc" id="L469">            Vecteur pente1 = this.calculPente(points);</span>

<span class="pc bpc" id="L471" title="1 of 4 branches missed.">            if ((pente1.getValx() == 0) &amp;&amp; (pente1.getValy() == 0)) {</span>
                // projection sur le triangle entier dans le cas d'une surface horizontale
<span class="fc" id="L473">                bassinVersant.add(this);</span>

<span class="fc bfc" id="L475" title="All 2 branches covered.">                if (segments.get(segmentAB).getTridroit() &gt; 0) {</span>
<span class="fc bfc" id="L476" title="All 2 branches covered.">                    if (triangles.get(segments.get(segmentAB).getTridroit()).equals(this)) {</span>
<span class="pc bpc" id="L477" title="1 of 2 branches missed.">                        if (segments.get(segmentAB).getTrigauche() &gt; 0) {</span>
<span class="fc" id="L478">                            triangles.get(segments.get(segmentAB).getTrigauche()).calculProjete(segmentAB, triangles, segments, points, bassinVersant);</span>

                        }
                    } else {
<span class="fc" id="L482">                        triangles.get(segments.get(segmentAB).getTridroit()).calculProjete(segmentAB, triangles, segments, points, bassinVersant);</span>
                    }
                }

<span class="fc bfc" id="L486" title="All 2 branches covered.">                if (segments.get(segmentAC).getTridroit() &gt; 0) {</span>
<span class="fc bfc" id="L487" title="All 2 branches covered.">                    if (triangles.get(segments.get(segmentAC).getTridroit()).equals(this)) {</span>
<span class="pc bpc" id="L488" title="1 of 2 branches missed.">                        if (segments.get(segmentAC).getTrigauche() &gt; 0) {</span>

<span class="fc" id="L490">                            triangles.get(segments.get(segmentAC).getTrigauche()).calculProjete(segmentAC, triangles, segments, points, bassinVersant);</span>

                        }
                    } else {
<span class="fc" id="L494">                        triangles.get(segments.get(segmentAC).getTridroit()).calculProjete(segmentAC, triangles, segments, points, bassinVersant);</span>
                    }
                }
            } else {

               
<span class="fc" id="L500">                double anglePente = pente1.calculAngle();</span>
                
<span class="fc bfc" id="L502" title="All 4 branches covered.">                if (((Vecteur.distAngle(angleBC, anglePente) - Vecteur.distAngle(angleBC, angleCB)) &lt; approximationAngulaire) || (Math.abs(angleBC - anglePente) &lt; approximationAngulaire)) {</span>
                    //1er cas: pas de propagation:
                    //rien pour le moment, il n'y a pas de propagation donc pas d'appel récursif

                } else {
                    //2eme cas : propagation totale du triangle
<span class="fc bfc" id="L508" title="All 4 branches covered.">                    if (((Vecteur.distAngle(angleAB, anglePente) - Vecteur.distAngle(angleAB, angleAC)) &lt; approximationAngulaire) || (Math.abs(angleAB - anglePente) &lt; approximationAngulaire)) {</span>

                        // projection sur le triangle entier
<span class="fc" id="L511">                        bassinVersant.add(this);</span>

<span class="fc bfc" id="L513" title="All 2 branches covered.">                        if (segments.get(segmentAB).getTridroit() &gt; 0) {</span>
<span class="fc bfc" id="L514" title="All 2 branches covered.">                            if (triangles.get(segments.get(segmentAB).getTridroit()).equals(this)) {</span>
<span class="pc bpc" id="L515" title="1 of 2 branches missed.">                                if (segments.get(segmentAB).getTrigauche() &gt; 0) {</span>
<span class="fc" id="L516">                                    triangles.get(segments.get(segmentAB).getTrigauche()).calculProjete(segmentAB, triangles, segments, points, bassinVersant);</span>

                                }
                            } else {
<span class="fc" id="L520">                                triangles.get(segments.get(segmentAB).getTridroit()).calculProjete(segmentAB, triangles, segments, points, bassinVersant);</span>
                            }
                        }

<span class="fc bfc" id="L524" title="All 2 branches covered.">                        if (segments.get(segmentAC).getTridroit() &gt; 0) {</span>
<span class="fc bfc" id="L525" title="All 2 branches covered.">                            if (triangles.get(segments.get(segmentAC).getTridroit()).equals(this)) {</span>
<span class="pc bpc" id="L526" title="1 of 2 branches missed.">                                if (segments.get(segmentAC).getTrigauche() &gt; 0) {</span>
<span class="fc" id="L527">                                    triangles.get(segments.get(segmentAC).getTrigauche()).calculProjete(segmentAC, triangles, segments, points, bassinVersant);</span>

                                }
                            } else {
<span class="fc" id="L531">                                triangles.get(segments.get(segmentAC).getTridroit()).calculProjete(segmentAC, triangles, segments, points, bassinVersant);</span>
                            }
                        }

                    } else { // Les 2 cas précédents ont priorité sur les 2 qui suivent pour les cas qui sont en commun

<span class="fc" id="L537">                        Point3D separation = new Point3D(0, 0, 0);</span>

                        //3eme cas : propagation partielle sur le triangle, comprenant une partie du segment AC
<span class="fc bfc" id="L540" title="All 2 branches covered.">                        if (Vecteur.distAngle(angleCB, anglePente) &lt;= Vecteur.distAngle(angleCB, angleAB)) {</span>

                            //projection de B sur le segmentAC suivant la pente 
<span class="fc" id="L543">                            separation = Point3D.intersection(segments.get(segmentAC), points.get(pointB), pente, points);</span>
<span class="fc" id="L544">                            int separateur = points.size();</span>
<span class="fc" id="L545">                            points.add(separation);</span>
<span class="fc" id="L546">                            segments.get(segmentAC).decoupe(separateur, triangles.indexOf(this), pointB, bassinVersant, points, segments, triangles);</span>

                        }

                        //4ème cas : propagation partielle sur le triangle, comprenant une partie du segment AB
<span class="fc bfc" id="L551" title="All 2 branches covered.">                        if (Vecteur.distAngle(angleAC, anglePente) &lt;= Vecteur.distAngle(angleAC, angleBC)) {</span>

                            // projection de C sur le segmentAB suivant la pente
<span class="fc" id="L554">                            separation = Point3D.intersection(segments.get(segmentAB), points.get(pointC), pente, points);</span>
<span class="fc" id="L555">                            int separateur = points.size();</span>
<span class="fc" id="L556">                            points.add(separation);</span>
<span class="fc" id="L557">                            segments.get(segmentAB).decoupe(separateur, triangles.indexOf(this), pointB, bassinVersant, points, segments, triangles);</span>

                        }
                    }
                }
            }
        }
<span class="fc" id="L564">    }</span>

    public void seekSegment(ArrayList&lt;Segment&gt; segments, ArrayList&lt;Point3D&gt; points) {

<span class="nc" id="L568">        boolean found1 = false, found2 = false, found3 = false;</span>
<span class="nc" id="L569">        int position = 1;</span>
<span class="nc bnc" id="L570" title="All 2 branches missed.">        for (Segment segment : segments) {</span>

<span class="nc bnc" id="L572" title="All 4 branches missed.">            if ((segment.getPoint1() == this.getPoint1() &amp;&amp; segment.getPoint2() == this.getPoint2())</span>
<span class="nc bnc" id="L573" title="All 4 branches missed.">                    || (segment.getPoint2() == this.getPoint1() &amp;&amp; segment.getPoint1() == this.getPoint2())) {</span>

            }

<span class="nc" id="L577">        }</span>
<span class="nc" id="L578">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span></div></body></html>